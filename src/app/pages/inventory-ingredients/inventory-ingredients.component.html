<div *ngIf="showAddButton" nz-td [ngClass]="{ 'add-button-container': true }">
  <button (click)="onAdd()" nz-form [ngClass]="{ 'add-button': true }">
    Add
  </button>
</div>

<nz-drawer
  [nzBodyStyle]="{ overflow: 'auto' }"
  [nzMaskClosable]="false"
  [nzWidth]="920"
  [nzVisible]="visible"
  nzTitle="Inventory Ingredient"
  [nzFooter]="footerTpl"
  (nzOnClose)="close()"
>
  <form nz-form *nzDrawerContent (ngSubmit)="submitForm()">

    <div nz-row [nzGutter]="8" class="mt" style="margin: 20px 0 10px 0">
      <div nz-col nzSpan="12">
        <nz-form-item >
          <nz-form-label for="ingredientName">Ingredient Name</nz-form-label>

          <nz-form-control>
            <nz-select
              nzPlaceHolder="Enter ingredient name"
              [nzAllowClear]="true"
              [(ngModel)]="ingredientName"
              name="ingredientName"
              [nzMaxTagCount]="1"
              nzShowSearch
              (ngModelChange)="onSelectSetCaloriesPerUnit()"
            >
              <nz-option
                nz-input
                id="ingredientName"
                *ngFor="let el of ingredientList"
                [nzValue]="el.ingredientName"
                [nzLabel]="el.ingredientName"
              ></nz-option>
            </nz-select>
          </nz-form-control>

        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="8" class="mt" style="margin: 0 0 10px 0">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label>Liquid</nz-form-label>
          <nz-form-control>
            <nz-select
              nzPlaceHolder="Enter liquid or not"
              [nzAllowClear]="true"
              [(ngModel)]="liquid"
              name="liquid"
              [nzMaxTagCount]="1"
              nzShowSearch
              (ngModelChange)="onLiquidChange(liquid)"
            >
              <nz-option
                nz-input
                id="liquid"
                *ngFor="let el of booleanList"
                [nzValue]="el"
                [nzLabel]="el"
              ></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="8" class="mt" style="margin: 0 0 10px 0">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label>Unit Of Measurement</nz-form-label>
          <nz-form-control>
            <nz-select
              nzPlaceHolder="Enter unit of measurement"
              [nzAllowClear]="true"
              [(ngModel)]="unitOfStock"
              name="unitOfStock"
              [nzMaxTagCount]="1"
              nzShowSearch
            >
              <nz-option
                nz-input
                id="unitOfStock"
                *ngFor="let el of unitOfQuantityOptions"
                [nzValue]="el"
                [nzLabel]="el"
              ></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="8" class="mt" style="margin: 0 0 10px 0">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label>Category</nz-form-label>
          <nz-form-control>
            <nz-select
              nzPlaceHolder="Enter category"
              [nzAllowClear]="true"
              [(ngModel)]="categoryName"
              name="categoryName"
              [nzMaxTagCount]="1"
              nzShowSearch
            >
              <nz-option
                nz-input
                id="categoryName"
                *ngFor="let el of categoryList"
                [nzValue]="el.categoryName"
                [nzLabel]="el.categoryName"
              ></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="8" class="mt" style="margin: 0 0 10px 0">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label>Calories Per Unit</nz-form-label>
          <nz-form-control>
            <input
              nz-input
              [(ngModel)]="caloriesPerUnit"
              name="caloriesPerUnit"
              placeholder="Enter calories per unit"
              [disabled] = true
            />
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="8" class="mt" style="margin: 0 0 10px 0">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label>Reorder Point</nz-form-label>
          <nz-form-control>
            <input
              nz-input
              [(ngModel)]="reorderPoint"
              name="reorderPoint"
              placeholder="Enter reorder point"
            />
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="8" class="mt" style="margin: 0 0 10px 0">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label class="label">Ideal Storing Temperature (°C)</nz-form-label>
          <nz-form-control>
            <input
              nz-input
              [(ngModel)]="idealStoringTemperature"
              name="idealStoringTemperature"
              placeholder="Enter ideal storing temperature in celsius"
            />
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="8" class="mt" style="margin: 0 0 10px 0">
      <div nz-col nzSpan="12">
        <nz-form-item>
          <nz-form-label>Perishable</nz-form-label>
          <nz-form-control>
            <nz-select
              nzPlaceHolder="Enter perishable or not"
              [nzAllowClear]="true"
              [(ngModel)]="perishable"
              name="perishable"
              [nzMaxTagCount]="1"
              nzShowSearch
            >
              <nz-option
                nz-input
                id="perishable"
                *ngFor="let el of booleanList"
                [nzValue]="el"
                [nzLabel]="el"
              ></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>

    <div nz-row [nzGutter]="8" class="mt" style="margin: 0 0 10px 0">
      <div nz-col nzSpan="24">
        <nz-form-item>
          <nz-form-label>Description</nz-form-label>
          <nz-form-control>
            <textarea
              nz-input
              [(ngModel)]="description"
              name="description"
              placeholder="Enter description"
              [nzAutosize]="{ minRows: 4, maxRows: 4 }"
            ></textarea>
          </nz-form-control>
        </nz-form-item>
      </div>
    </div>
  </form>

  <ng-template #footerTpl>
    <div style="float: right">
      <button nz-button style="margin-right: 8px" (click)="close()">
        Cancel
      </button>
      <button nz-button nzType="primary" (click)="submitForm()">Submit</button>
    </div>
  </ng-template>
</nz-drawer>

<h2>{{ tableTitle }}</h2>
<nz-table
  #rowSelectionTable
  [nzData]="createdIngredients"
  [nzFrontPagination]="frontPagination"
  [nzTotal]="totalNumberOfData"
  [nzPageIndex]="pageIndex"
  [nzPageSize]="pageSize"
  [nzShowPagination]="showPagination"
  [nzPaginationPosition]="paginationPosition"
  [nzPaginationType]="paginationType"
  [nzBordered]="showBorder"
  [nzOuterBordered]="outerBordered"
  [nzSize]="sizeOfTable"
  [nzLoading]="loadingStatus"
  [nzFooter]="tableFooter"
  [nzNoResult]="noResult"
  [nzShowQuickJumper]="showQuickJumper"
  [nzHideOnSinglePage]="hidePaginationOnSinglePage"
>
  <thead>
    <tr>
      <th>Ingredient Name</th>
      <th>Current Stock</th>
      <th>UOM</th>
      <!-- <th>Avg Cost Per Unit</th> -->
      <th>Calories Per Unit</th>
      <th>Reorder Point</th>
      <th>Description</th>
      <th>Storing Temperature (°C)</th>
      <th>Category</th>
      <th>Last Updated</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let data of rowSelectionTable.data">
      <td>{{ data.ingredientName }}</td>
      <td>{{ data.currentStockQuantity }}</td>
      <td>{{ data.unitOfStock }}</td>
      <!-- <td>{{ data.costPerUnit }}</td> -->
      <td>{{ data.caloriesPerUnit }}</td>
      <td>{{ data.reorderPoint }}</td>
      <td style="width: 10vw;">{{ data.description }}</td>
      <td>{{ data.idealStoringTemperature }}</td>
      <td>{{ data.category.categoryName }}</td>
      <td>{{ data.updatedAt }}</td>

      <td>
        <button *ngIf="showDeleteButton" nz-td nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="onDelete(data.id)" [ngClass]="{ 'delete-button': true }">
          <span nz-icon nzType="delete" nzTheme="outline"></span>
        </button>
        <button *ngIf="showEditButton" nz-td (click)="onEdit(data)" [ngClass]="{ 'edit-button': true }">
          <span nz-icon nzType="edit" nzTheme="outline"></span>
        </button>
      </td>
    </tr>
  </tbody>
</nz-table>
